<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EPS vs. TD: Team Competition (Simplified Scoring)</title>
    <style>
        :root {
            --team1-color: #3498db; /* Blue */
            --team2-color: #e74c3c; /* Red */
            --success-color: #2ecc71; /* Green */
            --danger-color: #f39c12; /* Yellow/Orange */
        }
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background-color: #f4f7f9;
        }

        .container {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            max-width: 700px;
            width: 90%;
            text-align: center;
        }

        h1 {
            color: #2c3e50;
            margin-bottom: 20px;
        }

        /* --- Scoreboard & Setup Styles --- */
        #setup-box, .scoreboard {
            margin-bottom: 20px;
            padding: 15px;
            border-radius: 8px;
            background-color: #ecf0f1;
        }

        .scoreboard {
            display: flex;
            justify-content: space-around;
            font-size: 1.2em;
            font-weight: bold;
        }

        .team-score {
            padding: 10px 15px;
            border-radius: 5px;
            width: 45%;
        }
        
        #team1-score { background-color: var(--team1-color); color: white; }
        #team2-score { background-color: var(--team2-color); color: white; }
        
        #setup-box input {
            padding: 8px;
            margin: 5px;
            border: 1px solid #ccc;
            border-radius: 4px;
            width: 150px;
        }
        
        #setup-box button {
            background-color: var(--success-color);
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
        }
        
        /* --- Quiz & Timer Styles --- */
        #question-box {
            background-color: #34495e;
            color: white;
            padding: 25px;
            border-radius: 8px;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
            font-size: 1.3em;
            font-weight: bold;
            text-align: center;
        }

        #timer-display {
            font-size: 1.5em;
            font-weight: bold;
            color: var(--danger-color);
            margin-bottom: 15px;
        }

        /* Ready Button */
        #ready-btn {
            background-color: var(--team1-color);
            color: white;
            width: 100%;
            padding: 15px;
            margin-bottom: 15px;
        }
        #ready-btn:hover { background-color: #2980b9; }

        /* Scoring Controls */
        #scoring-controls {
            display: none;
            padding-top: 20px;
            margin-top: 15px;
            border-top: 1px solid #ccc;
        }
        
        .scoring-group {
            margin-bottom: 15px;
            padding: 10px;
            border-radius: 5px;
            background-color: #f0f4f7;
        }

        .scoring-group h3 {
            margin-top: 0;
            color: #2c3e50;
        }
        
        /* Radio Button Styling */
        .radio-buttons label {
            padding: 10px 15px;
            margin: 0 5px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.2s;
            display: inline-block;
            font-weight: bold;
        }

        .radio-buttons input[type="radio"] {
            display: none;
        }
        
        /* Team Toggle */
        #team-toggles input:checked + label {
            background-color: var(--team1-color);
            color: white;
            box-shadow: 0 3px 5px rgba(0, 0, 0, 0.2);
        }
        #team-toggles label[for="team2"]:hover { background-color: var(--team2-color); }
        #team-toggles input:checked + label[for="team2"] {
            background-color: var(--team2-color);
            color: white;
        }
        
        /* Outcome Toggle */
        #outcome-toggles input:checked + label.correct-label {
            background-color: var(--success-color);
            color: white;
        }
        #outcome-toggles input:checked + label.incorrect-label {
            background-color: var(--danger-color);
            color: white;
        }

        #submit-btn {
            background-color: var(--success-color);
            color: white;
            width: 100%;
            margin-top: 15px;
            padding: 15px;
        }
        #submit-btn:hover { background-color: #27ad60; }
        
        /* Next Button */
        #next-btn {
            background-color: #3498db;
            color: white;
            width: 100%;
            padding: 15px;
            margin-top: 15px;
            display: none;
        }

        /* Feedback Box */
        #feedback-box {
            margin-top: 20px;
            padding: 15px;
            border-radius: 5px;
            font-weight: bold;
            min-height: 50px;
        }

        .correct-fb {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .incorrect-fb {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>🧠 EPS vs. TD: Team Showdown</h1>

        <div id="setup-box">
            <input type="text" id="team1-name-input" value="Team Alpha" placeholder="Enter Team 1 Name">
            <input type="text" id="team2-name-input" value="Team Beta" placeholder="Enter Team 2 Name">
            <button id="start-setup-btn" onclick="setupGame()">Start Game</button>
        </div>

        <div class="scoreboard" style="display: none;">
            <div class="team-score" id="team1-score"><span id="team1-name"></span>: <span id="team1-points">0</span></div>
            <div class="team-score" id="team2-score"><span id="team2-name"></span>: <span id="team2-points">0</span></div>
        </div>

        <div id="timer-display">Ready to Start!</div>
        <div id="question-box">Click 'Ready' when both teams are set for the question.</div>

        <button id="ready-btn" onclick="startQuestion()" style="display: none;">Ready for Question 1 / 9</button>
        
        <div id="scoring-controls">
            <div class="scoring-group">
                <h3>Award Point to:</h3>
                <div class="radio-buttons" id="team-toggles">
                    <input type="radio" id="team1" name="scoringTeam" value="1" required>
                    <label for="team1">Team Alpha</label>
                    <input type="radio" id="team2" name="scoringTeam" value="2">
                    <label for="team2">Team Beta</label>
                </div>
            </div>

            <div class="scoring-group">
                <h3>Answer Outcome:</h3>
                <div class="radio-buttons" id="outcome-toggles">
                    <input type="radio" id="correct" name="scoringOutcome" value="correct" required>
                    <label for="correct" class="correct-label">Correct Answer</label>
                    <input type="radio" id="incorrect" name="scoringOutcome" value="incorrect">
                    <label for="incorrect" class="incorrect-label">Incorrect Answer</label>
                </div>
            </div>

            <button id="submit-btn" onclick="submitScore()">SUBMIT ANSWER</button>
        </div>
        
        <button id="next-btn" onclick="nextQuestion()">Next Question</button>

        <div id="feedback-box"></div>
    </div>

    <script>
        // Use standard text for the explanations to avoid LaTeX formatting issues
        const quizQuestions = [
            {
                statement: "Extrapyramidal side effects (EPS) typically develop after months or years of medication exposure.",
                answer: false, // Fiction
                explanation: "FICTION. EPS can occur **acutely** (days to weeks). TD typically develops after months or years of exposure."
            },
            {
                statement: "Tardive Dyskinesia (TD) is primarily caused by **acute** dopamine D2 receptor blockade.",
                answer: false, // Fiction
                explanation: "FICTION. **EPS** is due to acute blockade. TD is thought to result from **chronic** blockade causing receptor supersensitivity."
            },
            {
                statement: "Akathisia is an EPS symptom characterized by subjective and objective restlessness.",
                answer: true, // Fact
                explanation: "FACT. Akathisia is a common EPS. It may respond to **beta-blockers** (e.g., propranolol) or benzodiazepines."
            },
            {
                statement: "Involuntary, repetitive movements, most often affecting the mouth, face, and tongue, are characteristic of **Tardive Dyskinesia (TD)**.",
                answer: true, // Fact
                explanation: "FACT. These involuntary movements are the hallmark of TD. EPS symptoms are different (e.g., tremor, rigidity, sustained contractions)."
            },
            {
                statement: "The first-line management for acute dystonia (a type of EPS) is switching the patient to an SGA like clozapine.",
                answer: false, // Fiction
                explanation: "FICTION. For acute dystonia, **anticholinergic agents** (e.g., benztropine) are immediately effective. Dose reduction is often the first step."
            },
            {
                statement: "VMAT2 inhibitors (e.g., valbenazine) are the recommended first-line pharmacological treatment for moderate to severe TD.",
                answer: true, // Fact
                explanation: "FACT. VMAT2 inhibitors are the gold standard pharmacological treatment for TD. "
            },
            {
                statement: "Parkinsonism (tremor, rigidity, bradykinesia) is classified as an EPS.",
                answer: true, // Fact
                explanation: "FACT. Parkinsonism is a classic EPS resulting from dopamine blockade, which creates a syndrome similar to idiopathic Parkinson's disease."
            },
            {
                statement: "Anticholinergic agents (e.g., benztropine) can be used as a primary treatment to reduce the symptoms of Tardive Dyskinesia.",
                answer: false, // Fiction
                explanation: "FICTION. Anticholinergics should be **avoided** in TD as they can potentially worsen the symptoms."
            },
            {
                statement: "Vitamin E is considered the most robust and highly recommended first-line agent for TD.",
                answer: false, // Fiction
                explanation: "FICTION. VMAT2 inhibitors are first-line. Vitamin E may have modest benefit but evidence is less robust."
            }
        ];

        let currentQuestionIndex = 0;
        const totalQuestions = quizQuestions.length;
        let teams = [
            { name: "Team Alpha", score: 0, id: 1 },
            { name: "Team Beta", score: 0, id: 2 }
        ];
        let timerId;
        const READ_TIME = 5; // seconds to read the question
        const ANSWER_TIME = 10; // seconds to answer

        // DOM elements
        const setupBox = document.getElementById('setup-box');
        const scoreboard = document.querySelector('.scoreboard');
        const team1NameInput = document.getElementById('team1-name-input');
        const team2NameInput = document.getElementById('team2-name-input');
        const team1NameDisplay = document.getElementById('team1-name');
        const team2NameDisplay = document.getElementById('team2-name');
        const team1PointsDisplay = document.getElementById('team1-points');
        const team2PointsDisplay = document.getElementById('team2-points');
        
        const teamToggle1Label = document.querySelector('label[for="team1"]');
        const teamToggle2Label = document.querySelector('label[for="team2"]');

        const questionBox = document.getElementById('question-box');
        const timerDisplay = document.getElementById('timer-display');
        const readyBtn = document.getElementById('ready-btn');
        const nextBtn = document.getElementById('next-btn');
        const scoringControls = document.getElementById('scoring-controls');
        const submitBtn = document.getElementById('submit-btn');
        const feedbackBox = document.getElementById('feedback-box');


        function updateScoreboard() {
            team1NameDisplay.textContent = teams[0].name;
            team2NameDisplay.textContent = teams[1].name;
            team1PointsDisplay.textContent = teams[0].score;
            team2PointsDisplay.textContent = teams[1].score;
            
            // Update labels in scoring controls
            teamToggle1Label.textContent = teams[0].name;
            teamToggle2Label.textContent = teams[1].name;
        }

        function setupGame() {
            // Set team names from input
            teams[0].name = team1NameInput.value || "Team Alpha";
            teams[1].name = team2NameInput.value || "Team Beta";
            
            // Hide setup, show game elements
            setupBox.style.display = 'none';
            scoreboard.style.display = 'flex';
            readyBtn.style.display = 'block';

            // Reset game state
            currentQuestionIndex = 0;
            teams[0].score = 0;
            teams[1].score = 0;
            readyBtn.textContent = `Ready for Question 1 / ${totalQuestions}`;
            questionBox.textContent = "Click 'Ready' when both teams are set for the question.";
            timerDisplay.textContent = "Game started!";
            feedbackBox.textContent = '';
            feedbackBox.className = '';
            scoringControls.style.display = 'none';

            updateScoreboard();
        }


        function startQuestion() {
            if (currentQuestionIndex >= totalQuestions) {
                endGame();
                return;
            }

            const q = quizQuestions[currentQuestionIndex];
            
            // Reset for new question
            clearTimeout(timerId);
            nextBtn.style.display = 'none';
            readyBtn.style.display = 'none';
            scoringControls.style.display = 'none';
            feedbackBox.textContent = '';
            feedbackBox.className = '';
            
            // Clear radio selections
            document.querySelectorAll('input[name="scoringTeam"]').forEach(radio => radio.checked = false);
            document.querySelectorAll('input[name="scoringOutcome"]').forEach(radio => radio.checked = false);
            
            // PHASE 1: Reading Timer (5 seconds)
            let readTimeLeft = READ_TIME;
            questionBox.textContent = q.statement;
            
            const readingCountdown = () => {
                if (readTimeLeft <= 0) {
                    // PHASE 2: Answering Timer (10 seconds)
                    startAnswerPhase();
                    return;
                }
                timerDisplay.textContent = `Time to Read: ${readTimeLeft} seconds...`;
                readTimeLeft--;
                timerId = setTimeout(readingCountdown, 1000);
            };

            readingCountdown();
        }

        function startAnswerPhase() {
            questionBox.textContent = "FACT or FICTION?"; // Show the prompt
            scoringControls.style.display = 'block';
            
            let answerTimeLeft = ANSWER_TIME;
            
            const answerCountdown = () => {
                if (answerTimeLeft < 0) {
                    timerDisplay.textContent = "TIME'S UP! Score the answer.";
                    return;
                }
                timerDisplay.textContent = `Time to Answer: ${answerTimeLeft} seconds`;
                answerTimeLeft--;
                timerId = setTimeout(answerCountdown, 1000);
            };

            answerCountdown();
        }

        function submitScore() {
            clearTimeout(timerId); // Stop the timer

            const selectedTeamValue = document.querySelector('input[name="scoringTeam"]:checked')?.value;
            const selectedOutcome = document.querySelector('input[name="scoringOutcome"]:checked')?.value;
            
            if (!selectedTeamValue || !selectedOutcome) {
                alert("Please select both a Team and an Answer Outcome before submitting.");
                return;
            }

            const teamId = parseInt(selectedTeamValue);
            const team = teams[teamId - 1];
            const q = quizQuestions[currentQuestionIndex];
            
            // Determine the result based on your click
            const isCorrect = selectedOutcome === 'correct';

            if (isCorrect) {
                team.score++;
                feedbackBox.textContent = `✅ ${team.name} scores a point! The correct answer is ${q.answer ? 'FACT' : 'FICTION'}. ${q.explanation}`;
                feedbackBox.className = 'correct-fb';
            } else {
                feedbackBox.textContent = `❌ Incorrect. No point awarded. The correct answer is ${q.answer ? 'FACT' : 'FICTION'}. ${q.explanation}`;
                feedbackBox.className = 'incorrect-fb';
            }
            
            questionBox.textContent = q.statement; // Redisplay the full question
            timerDisplay.textContent = "Answer Scored. Click Next Question.";
            scoringControls.style.display = 'none';
            nextBtn.style.display = 'block';

            updateScoreboard();
        }

        function nextQuestion() {
            currentQuestionIndex++;
            readyBtn.textContent = `Ready for Question ${currentQuestionIndex + 1} / ${totalQuestions}`;

            if (currentQuestionIndex < totalQuestions) {
                readyBtn.style.display = 'block';
                nextBtn.style.display = 'none';
                questionBox.textContent = "Click 'Ready' when both teams are set for the next question.";
                timerDisplay.textContent = "Next question is ready.";
            } else {
                endGame();
            }
        }

        function endGame() {
            readyBtn.style.display = 'none';
            nextBtn.style.display = 'none';
            
            const winner = teams[0].score > teams[1].score ? teams[0].name : 
                            (teams[1].score > teams[0].score ? teams[1].name : "It's a tie!");
            
            questionBox.innerHTML = `GAME OVER! ${winner === "It's a tie!" ? winner : winner + ' wins!'} <br>Final Score: ${teams[0].score} - ${teams[1].score}`;
            timerDisplay.textContent = "Final Results";
            feedbackBox.textContent = 'Thank you for playing! Click "Start Game" above to play again.';
            feedbackBox.className = 'correct-fb';
            
            // Show setup button again to allow replay
            document.getElementById('start-setup-btn').textContent = "Start New Game";
            setupBox.style.display = 'block';
        }

        // Initial setup on load
        updateScoreboard();
        document.getElementById('start-setup-btn').textContent = "Start Game";
    </script>

</body>
</html>
